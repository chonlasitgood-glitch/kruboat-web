<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üíª</text></svg>">
    <!-- Google Fonts: Sarabun (Formal Thai Font) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f0f9ff; /* Light Sky Blue background */
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
            opacity: 0;
            transform: translateY(10px);
        }
        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        /* Hide scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #93c5fd; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #60a5fa; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <!-- Main Container -->
    <div class="w-full max-w-md bg-white rounded-2xl shadow-xl overflow-hidden border border-blue-100">
        
        <!-- Header Section (Blue Theme) -->
        <div class="bg-blue-600 text-white p-8 text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-full opacity-10">
                <i class="fas fa-book-open text-9xl -ml-10 -mt-10 absolute"></i>
            </div>
            <div class="relative z-10">
                <h1 class="text-2xl font-bold mb-2 tracking-wide">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h1>
                <p class="text-blue-100 text-sm font-light">‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö</p>
            </div>
        </div>

        <!-- Input Section -->
        <div class="p-8">
            
            <!-- 1. Subject Selection -->
            <div class="mb-5">
                <label for="subjectSelect" class="block text-sm font-medium text-slate-600 mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</label>
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-layer-group text-blue-400"></i>
                    </div>
                    <select id="subjectSelect" class="block w-full pl-10 pr-3 py-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-slate-700 bg-white appearance-none cursor-pointer shadow-sm">
                        <!-- Options injected by JS -->
                    </select>
                    <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none text-slate-500">
                        <i class="fas fa-chevron-down text-xs"></i>
                    </div>
                </div>
            </div>

            <!-- 2. Student ID Input -->
            <div class="mb-6">
                <label for="studentId" class="block text-sm font-medium text-slate-600 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-id-card text-blue-400"></i>
                    </div>
                    <input type="text" id="studentId" 
                        class="block w-full pl-10 pr-3 py-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all text-lg shadow-sm placeholder-slate-300" 
                        placeholder="‡πÄ‡∏ä‡πà‡∏ô 7001" 
                        onkeypress="handleEnter(event)">
                </div>
            </div>

            <!-- Button -->
            <button onclick="checkScore()" 
                id="searchBtn"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md transition-all duration-300 transform active:scale-95 flex items-center justify-center gap-2">
                <span>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>
                <i class="fas fa-search"></i>
            </button>
        </div>

        <!-- Result Section -->
        <div id="resultArea" class="hidden bg-slate-50 border-t border-slate-200 min-h-[100px]">
            <!-- Content injected by JS -->
        </div>

        <!-- Loading -->
        <div id="loading" class="hidden p-8 text-center">
            <div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-200 border-t-blue-600 mb-2"></div>
            <p class="text-blue-500 text-sm">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="hidden p-6 bg-red-50 text-red-600 text-center border-t border-red-100">
            <i class="fas fa-exclamation-circle text-2xl mb-2"></i>
            <p id="errorText">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
        </div>
    </div>

    <!-- Footer -->
    <div class="mt-8 text-center text-blue-400 text-xs opacity-70">
        <p>&copy; 2025 ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ ‡∏Ñ‡∏£‡∏π‡πÇ‡∏ö‡πä‡∏ó ‡∏ä‡∏•‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏û‡∏±‡∏ô‡∏ò‡πå | ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ chonlasitgood@gmail.com</p>
    </div>

    <script>
        // ==========================================
        // ‚öôÔ∏è ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (CONFIGURATION)
        // ==========================================
        
        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏•‡∏∞‡∏•‡∏¥‡∏á‡∏Å‡πå CSV ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
        const SUBJECTS_CONFIG = [
            { 
                name: "‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ", 
                url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTVpflLkPsSsgyctG0BR8JLBZtlgRkvxux83OWEzpcy62alQKlsR5cfdYIpkPMV8EZkSgStNhdG1oTA/pub?gid=0&single=true&output=csv" 
            },
            { 
                name: "‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå", 
                url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTVpflLkPsSsgyctG0BR8JLBZtlgRkvxux83OWEzpcy62alQKlsR5cfdYIpkPMV8EZkSgStNhdG1oTA/pub?gid=52363478&single=true&output=csv" 
            },
            { 
                name: "‡∏Ñ‡πâ‡∏ô‡∏Ñ‡∏ß‡πâ‡∏≤‡∏≠‡∏¥‡∏™‡∏£‡∏∞ (IS)", 
                url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTVpflLkPsSsgyctG0BR8JLBZtlgRkvxux83OWEzpcy62alQKlsR5cfdYIpkPMV8EZkSgStNhdG1oTA/pub?gid=1307397697&single=true&output=csv" 
            },
            { 
                name: "Media & Technology", 
                url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTVpflLkPsSsgyctG0BR8JLBZtlgRkvxux83OWEzpcy62alQKlsR5cfdYIpkPMV8EZkSgStNhdG1oTA/pub?gid=326093966&single=true&output=csv" 
            }
        ];

        // ==========================================
        // üöÄ ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å (MAIN LOGIC)
        // ==========================================

        const subjectSelect = document.getElementById('subjectSelect');
        const studentInput = document.getElementById('studentId');
        const resultArea = document.getElementById('resultArea');
        const loading = document.getElementById('loading');
        const errorMessage = document.getElementById('errorMessage');
        const searchBtn = document.getElementById('searchBtn');

        // Initial Setup
        window.onload = () => {
            initSubjectDropdown();
        };

        function initSubjectDropdown() {
            subjectSelect.innerHTML = SUBJECTS_CONFIG.map((subj, index) => 
                `<option value="${index}">${subj.name}</option>`
            ).join('');
        }

        function handleEnter(e) {
            if (e.key === 'Enter') checkScore();
        }

        async function checkScore() {
            const id = studentInput.value.trim();
            const subjectIndex = subjectSelect.value;
            const selectedSubject = SUBJECTS_CONFIG[subjectIndex];

            if (!id) {
                showError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô');
                return;
            }

            resetUI();
            loading.classList.remove('hidden');
            searchBtn.disabled = true;
            searchBtn.classList.add('opacity-75');

            try {
                let data = [];
                
                // --- Logic: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å URL ‡∏ï‡∏≤‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ---
                // (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ fetch, ‡∏ñ‡πâ‡∏≤‡∏•‡∏¥‡∏á‡∏Å‡πå demo ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ mock)
                if(selectedSubject.url.includes('l1l1l1') || selectedSubject.url.includes('SHEET_ID')) {
                    await new Promise(r => setTimeout(r, 600)); 
                    data = getMockData(selectedSubject.name); // ‡∏™‡πà‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤‡πÑ‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠ Mock ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô
                } else {
                    const response = await fetch(selectedSubject.url);
                    if (!response.ok) throw new Error('Network response was not ok');
                    const csvText = await response.text();
                    data = parseCSV(csvText);
                }
                
                const student = data.find(row => row['‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô'] == id);

                if (student) {
                    displayResult(student, selectedSubject.name);
                } else {
                    showError(`‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™ ${id} ‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏ô‡∏µ‡πâ`);
                }

            } catch (error) {
                console.error('Error:', error);
                // Fallback Mock
                const data = getMockData(selectedSubject.name);
                const student = data.find(row => row['‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô'] == id);
                 if (student) displayResult(student, selectedSubject.name);
                 else showError('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠');
            } finally {
                loading.classList.add('hidden');
                searchBtn.disabled = false;
                searchBtn.classList.remove('opacity-75');
            }
        }

        function displayResult(student, subjectName) {
            // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏≤‡∏°‡∏ü‡∏≠‡∏£‡πå‡πÅ‡∏°‡∏ï‡πÉ‡∏´‡∏°‡πà: ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤, ‡∏ä‡∏∑‡πà‡∏≠, ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•, ‡∏´‡πâ‡∏≠‡∏á
            const prefix = student['‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤'] || '';
            const firstName = student['‡∏ä‡∏∑‡πà‡∏≠'] || '';
            const lastName = student['‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•'] || '';
            const room = student['‡∏´‡πâ‡∏≠‡∏á'] || '';
            
            // ‡∏£‡∏ß‡∏°‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡πá‡∏°
            const studentName = `${prefix}${firstName} ${lastName}`.trim() || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠';
            const studentId = student['‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô'];
            
            let scoreHtml = '';

            // ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)
            const excludeKeys = ['‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤', '‡∏ä‡∏∑‡πà‡∏≠', '‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•', '‡∏´‡πâ‡∏≠‡∏á'];

            for (const [key, value] of Object.entries(student)) {
                // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ exclude ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
                if (!excludeKeys.includes(key) && key.trim() !== '') {
                    
                    const isTotal = key.includes('‡∏£‡∏ß‡∏°') || key.toLowerCase().includes('total');
                    
                    // --- Logic: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 0 ‡∏´‡∏£‡∏∑‡∏≠ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ---
                    const cleanValue = value ? value.trim() : '';
                    const isZeroOrEmpty = cleanValue === '0' || cleanValue === '' || cleanValue === '-';
                    
                    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ
                    let valueColorClass = 'text-slate-700'; // ‡∏™‡∏µ‡∏õ‡∏Å‡∏ï‡∏¥
                    if (isTotal) valueColorClass = 'text-white';
                    else if (isZeroOrEmpty) valueColorClass = 'text-red-500 font-bold'; // ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 0

                    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î Background
                    const bgClass = isTotal ? 'bg-blue-600 text-white shadow-md transform scale-[1.02]' : 'bg-white border border-slate-100';
                    const labelClass = isTotal ? 'text-blue-100' : 'text-slate-500';

                    scoreHtml += `
                        <div class="flex justify-between items-center p-3 rounded-lg ${bgClass} mb-2 transition-all">
                            <span class="text-sm font-medium ${labelClass}">${key}</span>
                            <span class="text-lg font-bold ${valueColorClass}">
                                ${cleanValue === '' ? '-' : cleanValue}
                            </span>
                        </div>
                    `;
                }
            }

            const html = `
                <div class="p-6 animate-fade-in">
                    <div class="text-center mb-6 pb-4 border-b border-slate-200">
                        <span class="text-xs font-semibold text-blue-500 bg-blue-50 px-2 py-1 rounded mb-2 inline-block">
                            ${subjectName}
                        </span>
                        <h2 class="text-xl font-bold text-slate-800">${studentName}</h2>
                        
                        <div class="flex justify-center gap-3 text-sm mt-2 text-slate-500">
                            <span class="flex items-center"><i class="fas fa-id-card mr-1.5 text-blue-400"></i>${studentId}</span>
                            ${room ? `<span class="flex items-center"><i class="fas fa-users mr-1.5 text-blue-400"></i>‡∏´‡πâ‡∏≠‡∏á ${room}</span>` : ''}
                        </div>
                    </div>
                    
                    <div class="space-y-1">
                        ${scoreHtml}
                    </div>

                    <div class="mt-6 text-center">
                         <button onclick="resetUI()" class="text-sm text-slate-400 hover:text-blue-600 underline transition-colors">‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á</button>
                    </div>
                </div>
            `;

            resultArea.innerHTML = html;
            resultArea.classList.remove('hidden');
        }

        function resetUI() {
            resultArea.classList.add('hidden');
            errorMessage.classList.add('hidden');
            resultArea.innerHTML = '';
        }

        function showError(msg) {
            errorMessage.classList.remove('hidden');
            document.getElementById('errorText').textContent = msg;
        }

        function parseCSV(csvText) {
            const lines = csvText.split(/\r\n|\n/);
            const headers = lines[0].split(',').map(h => h.trim());
            const result = [];
            for (let i = 1; i < lines.length; i++) {
                const currentLine = lines[i].split(',');
                if (currentLine.length === headers.length) {
                    const obj = {};
                    for (let j = 0; j < headers.length; j++) {
                        obj[headers[j]] = currentLine[j].trim();
                    }
                    result.push(obj);
                }
            }
            return result;
        }
    </script>
</body>
</html>